head(mtcars)
root.dir <- here::here()
knitr::opts_chunk$set(echo = TRUE, root.dir=root.dir)
knitr::opts_knit$set(root.dir = root.dir)
library(adegenet)
library(ips)
library(ggplot2)
library(ggtree)
library(heatmaply)
nbin<-fasta2DNAbin("data/haplotypes_AA_names.fas")
an<-as.alignment(nbin)
nm<-as.matrix(an)
nbinmat<-as.matrix(labels(nbin))
class(nbin)
dnbin<-dist.dna(nbin, model = "K80")
tree<-njs(dnbin)
ggt<-ggtree(tree, cex = 0.8, aes(color=branch.length))+scale_color_continuous(high='lightskyblue1',low='coral4')+geom_tiplab(align=TRUE, size=5)+geom_treescale(y = -1, color = "coral4", fontsize = 7)
njmsaplot<-msaplot(ggt, nbin, offset = 0.009, width=1, height = 0.5, color = c(rep("rosybrown", 1), rep("sienna1", 1), rep("lightgoldenrod1", 1), rep("lightskyblue1", 1)))
njmsaplot
pdf("figures/haplotype_tree.pdf", width = 11, height = 9, paper = "a4", pointsize=15)#save as pdf file
njmsaplot
dev.off()
library(isotone)
hap_den<- readxl::read_xlsx("Haplotype Distribution.xlsx", col_names = TRUE)
hap_den<-rbind(hap_den)
hap_den<- readxl::read_xlsx("Haplotype Distribution.xlsx", col_names = TRUE)
setwd("~/Desktop/UK_DRI/Manuscripts/Malaria/Data")
hap_den<- readxl::read_xlsx("Haplotype Distribution.xlsx", col_names = TRUE)
hap_den<-rbind(hap_den)
iso <-isoreg(hap_den$Frequency)
hap_den<- data.frame(iso, hap_den$Episodes, hap_den$Episodes)
hap_den<- rbind(iso, hap_den$Episodes, hap_den$Episodes)
head(hap_den)
View(hap_den)
hap_den<- readxl::read_xlsx("Haplotype Distribution.xlsx", col_names = TRUE)
hap_den<-rbind(hap_den)
iso <-isoreg(hap_den$Frequency)
iso <-isoreg(hap_den$Frequency)
View(iso)
plot(iso, plot.type = "row")
plot(iso)
git status
exit
q()
